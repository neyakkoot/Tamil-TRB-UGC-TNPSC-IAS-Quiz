<script type="text/javascript">
// ЁЯФ┤ родрпАро░рпНро╡рпБ: рокроХрпНроХроорпН роорпБро┤рпБроорпИропро╛роХ ро▓рпЛроЯрпН роЖрой рокро┐ро▒роХрпБ ро╕рпНроХро┐ро░ро┐рокрпНроЯрпИ роЗропроХрпНроХро╡рпБроорпН
// (async) роОройрпНро▒ родрпЗро╡рпИропро▒рпНро▒ ро╡ро╛ро░рпНродрпНродрпИ роЗроЩрпНроХро┐ро░рпБроирпНродрпБ роирпАроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ.
document.addEventListener('DOMContentLoaded', function(){

┬а // ЁЯФ╣ роХро┐роЯрпИроХрпНроХрпБроорпН ро╡ро┐ройро╛роЯро┐тАУро╡ро┐ройро╛ JSON роХрпЛрокрпНрокрпБроХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпН
┬а const quizList = {
┬а ┬а "UGC_NET_TAMIL_II_2008.json": "UGC NET Tamil тАУ 2008",
┬а ┬а "Language_Origin_Quiz.json": "роорпКро┤ро┐ родрпЛро▒рпНро▒роорпН ро╡ро┐ройро╛роЯро┐-ро╡ро┐ройро╛ (1тАУ20)"
┬а };

┬а // ЁЯФ╣ Dropdown роЙро░рпБро╡ро╛роХрпНроХрпБродро▓рпН
┬а const qWrap = document.getElementById('tv-quiz-wrap');
┬а const dropdown = document.createElement('select');
┬а dropdown.id = 'quizSelect';
┬а dropdown.style.cssText = "display:block;width:100%;margin-bottom:15px;padding:10px;border-radius:8px;border:1px solid #ccc;font-size:1rem;font-weight:600;";

┬а const defaultOpt = document.createElement('option');
┬а defaultOpt.value = '';
┬а defaultOpt.textContent = 'ЁЯза родрпЗро░рпНро╡рпБ роЪрпЖропрпНропрпБроорпН ро╡ро┐ройро╛роЯро┐-ро╡ро┐ройро╛ родрпКроХрпБрокрпНрокрпБ';
┬а defaultOpt.disabled = true;
┬а defaultOpt.selected = true;
┬а dropdown.appendChild(defaultOpt);

┬а for (const [file, title] of Object.entries(quizList)) {
┬а ┬а const opt = document.createElement('option');
┬а ┬а opt.value = file;
┬а ┬а opt.textContent = title;
┬а ┬а dropdown.appendChild(opt);
┬а }

┬а // Quiz рокроХрпБродро┐ропро┐ройрпН роорпЗро▓рпЗ dropdown роЪрпЗро░рпНроХрпНроХ
┬а const quizContainer = document.getElementById('tv-quiz');
┬а┬а
┬а // ЁЯФ┤ рокро┐ро┤рпИ роПро▒рпНрокроЯрпНроЯ роЗроЯроорпН роЗродрпБродро╛ройрпН. qWrap (null) роЖроХ роЗро░рпБроирпНродродрпБ.
┬а // роЗрокрпНрокрпЛродрпБ DOMContentLoaded роХрпНроХрпБрокрпН рокро┐ро▒роХрпБ роЗродрпБ роЪро░ро┐ропро╛роХ ро╡рпЗро▓рпИ роЪрпЖропрпНропрпБроорпН.
┬а if (qWrap && quizContainer) {
┬а ┬а qWrap.insertBefore(dropdown, quizContainer);
┬а } else {
┬а ┬а console.error("роорпБроХрпНроХро┐роп HTML роХрпВро▒рпБроХро│рпН (tv-quiz-wrap роЕро▓рпНро▓родрпБ tv-quiz) роХро╛рогрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ.");
┬а ┬а return; // роорпБроХрпНроХро┐ропрооро╛рой роХрпВро▒рпБроХро│рпН роЗро▓рпНро▓рпИ роОройрпНро▒ро╛ро▓рпН ро╕рпНроХро┐ро░ро┐рокрпНроЯрпИ роиро┐ро▒рпБродрпНродро╡рпБроорпН
┬а }

┬а // ЁЯФ╣ DOM роХрпВро▒рпБроХро│ро┐ройрпН роЪрпБроЯрпНроЯро┐роХро│рпН (References)
┬а const progressEl = document.getElementById('tv-progress');
┬а const qEl = document.getElementById('tv-question');
┬а const optsEl = document.getElementById('tv-options');
┬а const feedbackEl = document.getElementById('tv-feedback');
┬а const nextBtn = document.getElementById('tv-next');
┬а const resultsEl = document.getElementById('tv-results');

┬а const labels = ['(роЕ)','(роЖ)','(роЗ)','(роИ)', '(роЙ)']; // 5 рокродро┐ро▓рпНроХро│рпН ро╡ро░рпИ роЖродро░ро┐роХрпНроХрпБроорпН
┬а let quizData = [];
┬а let idx = 0, score = 0;

┬а // ЁЯФ╣ ро╡ро┐ройро╛роХрпНроХро│рпИ JSON-роЗро▓рпН роЗро░рпБроирпНродрпБ роПро▒рпНро▒рпБроорпН function
┬а async function loadQuiz(file) {
┬а ┬а progressEl.textContent = 'ро╡ро┐ройро╛роХрпНроХро│рпИ роПро▒рпНро▒рпБроХро┐ро▒родрпБ...';
┬а ┬а qEl.textContent = '';
┬а ┬а optsEl.innerHTML = '';
┬а ┬а feedbackEl.style.display = 'none';
┬а ┬а nextBtn.style.display = 'none';
┬а ┬а resultsEl.style.display = 'none';

┬а ┬а try {
┬а ┬а ┬а const res = await fetch(file, { cache: "no-cache" });
┬а ┬а ┬а if (!res.ok) throw new Error(`HTTP рокро┐ро┤рпИ: ${res.status} (роХрпЛрокрпНрокрпБ роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ)`);
┬а ┬а ┬а┬а
┬а ┬а ┬а const data = await res.json();
┬а ┬а ┬а quizData = data.questions || data;┬а
┬а ┬а ┬а┬а
┬а ┬а ┬а if (!quizData || quizData.length === 0) {
┬а ┬а ┬а ┬а throw new Error("ро╡ро┐ройро╛родрпН родро░ро╡рпБ роХро╛ро▓ро┐ропро╛роХ роЙро│рпНро│родрпБ роЕро▓рпНро▓родрпБ родро╡ро▒ро╛рой ро╡роЯро┐ро╡родрпНродро┐ро▓рпН роЙро│рпНро│родрпБ.");
┬а ┬а ┬а }
┬а ┬а ┬а┬а
┬а ┬а ┬а idx = 0; score = 0;
┬а ┬а ┬а renderQuestion();
┬а ┬а ┬а console.log(`тЬЕ ро╡ро┐ройро╛роЯро┐-ро╡ро┐ройро╛ "${file}" роПро▒рпНро▒рокрпНрокроЯрпНроЯродрпБ. (${quizData.length} ро╡ро┐ройро╛роХрпНроХро│рпН)`);
┬а ┬а┬а
┬а ┬а } catch (e) {
┬а ┬а ┬а progressEl.innerHTML = `тЪая╕П ро╡ро┐ройро╛роХрпНроХро│рпИ роПро▒рпНро▒ роорпБроЯро┐ропро╡ро┐ро▓рпНро▓рпИ.<br><small style="color:#dc3545;font-weight:normal;">рокро┐ро┤рпИ: ${e.message}</small>`;
┬а ┬а ┬а console.error("ро╡ро┐ройро╛роЯро┐-ро╡ро┐ройро╛ роПро▒рпНро▒рпБро╡родро┐ро▓рпН рокро┐ро┤рпИ (Quiz Load Error):", e);
┬а ┬а }
┬а }

┬а // ЁЯФ╣ ро╡ро┐ройро╛ роХро╛рогрпНрокро┐роХрпНроХрпБроорпН function
┬а function renderQuestion() {
┬а ┬а const q = quizData[idx];
┬а ┬а progressEl.textContent = `ро╡ро┐ройро╛ ${idx+1} / ${quizData.length}`;
┬а ┬а qEl.textContent = q.question;
┬а ┬а optsEl.innerHTML = '';
┬а ┬а feedbackEl.style.display = 'none';
┬а ┬а nextBtn.style.display = 'none';
┬а ┬а resultsEl.style.display = 'none';

┬а ┬а q.options.forEach((opt, i) => {
┬а ┬а ┬а const btn = document.createElement('button');
┬а ┬а ┬а btn.type = 'button';
┬а ┬а ┬а btn.className = 'option-btn';
┬а ┬а ┬а btn.style.cssText = "padding:12px;border-radius:8px;border:1px solid #ddd;background:#f9f9f9;text-align:left;cursor:pointer;font-size:1rem;";
┬а ┬а ┬а btn.innerHTML = `<strong style='margin-right:8px;'>${labels[i] || (i+1)+'.'}</strong> ${opt}`;
┬а ┬а ┬а btn.onclick = () => selectAnswer(i, btn);
┬а ┬а ┬а optsEl.appendChild(btn);
┬а ┬а });
┬а }

┬а // ЁЯФ╣ рокродро┐ро▓рпН родрпЗро░рпНро╡рпБ
┬а function selectAnswer(choice, btn) {
┬а ┬а const q = quizData[idx];
┬а ┬а const correct = q.answer;
┬а ┬а const buttons = optsEl.querySelectorAll('button');
┬а ┬а buttons.forEach(b => b.disabled = true);┬а

┬а ┬а if (choice === correct) {
┬а ┬а ┬а score++;
┬а ┬а ┬а btn.style.background = "#e6f7e9";
┬а ┬а ┬а btn.style.borderColor = "#28a745";
┬а ┬а } else {
┬а ┬а ┬а btn.style.background = "#fdecea";
┬а ┬а ┬а btn.style.borderColor = "#dc3545";
┬а ┬а ┬а if (buttons[correct]) {
┬а ┬а ┬а ┬а buttons[correct].style.background = "#e6f7e9";
┬а ┬а ┬а ┬а buttons[correct].style.borderColor = "#28a745";
┬а ┬а ┬а }
┬а ┬а }

┬а ┬а feedbackEl.style.display = 'block';
┬а ┬а feedbackEl.innerHTML = (choice === correct
┬а ┬а ┬а ? '<span style="color:green;font-weight:700;">тЬЕ роЪро░ро┐ропро╛рой ро╡ро┐роЯрпИ!</span>'
┬а ┬а ┬а : '<span style="color:red;font-weight:700;">тЭМ родро╡ро▒ро╛рой ро╡ро┐роЯрпИ.</span>')
┬а ┬а ┬а + `<div style="margin-top:10px;font-size:0.95rem;color:#333;">${q.explanation}</div>`;

┬а ┬а nextBtn.style.display = 'block';
┬а ┬а nextBtn.textContent = (idx < quizData.length - 1) ? 'роЕроЯрпБродрпНрод ро╡ро┐ройро╛' : 'роорпБроЯро┐ро╡рпБроХро│рпИроХрпН роХро╛рогрпН';
┬а }

┬а // ЁЯФ╣ роЕроЯрпБродрпНрод ро╡ро┐ройро╛ рокрпКродрпНродро╛ройрпН
┬а nextBtn.addEventListener('click', function(){
┬а ┬а idx++;
┬а ┬а if (idx < quizData.length) {
┬а ┬а ┬а renderQuestion();
┬а ┬а ┬а qWrap.scrollIntoView({behavior:'smooth'});
┬а _ } else {
┬а ┬а ┬а showResults();
┬а ┬а }
┬а });

┬а // ЁЯФ╣ роорпБроЯро┐ро╡рпБроХро│рпИроХрпН роХро╛рогрпНрокро┐родрпНродро▓рпН
┬а function showResults() {
┬а ┬а qEl.style.display = 'none';
┬а ┬а optsEl.style.display = 'none';
┬а ┬а progressEl.style.display = 'none';
┬а ┬а feedbackEl.style.display = 'none';
┬а ┬а nextBtn.style.display = 'none';

┬а ┬а resultsEl.style.display = 'block';
┬а ┬а resultsEl.innerHTML = `
┬а ┬а ┬а <h3 style="color:#0a58ca;margin-bottom:6px;">ро╡ро┐ройро╛роЯро┐-ро╡ро┐ройро╛ роорпБроЯро┐роирпНродродрпБ!</h3>
┬а ┬а ┬а <div style="font-size:1.1rem;font-weight:700;margin-bottom:8px;">роородро┐рокрпНрокрпЖрогрпН: ${score} / ${quizData.length}</div>
┬а ┬а ┬а <div style="margin-bottom:12px;">роЪродро╡рпАродроорпН: <strong>${((score/quizData.length)*100).toFixed(1)}%</strong></div>
┬а ┬а ┬а <button id="tv-retry" style="padding:10px 14px;border-radius:8px;background:#28a745;color:#fff;border:none;font-weight:700;cursor:pointer;">роорпАрогрпНроЯрпБроорпН роорпБропро▒рпНроЪро┐роХрпНроХ</button>
┬а ┬а `;
┬а ┬а┬а
┬а ┬а document.getElementById('tv-retry').onclick = () => {
┬а ┬а ┬а idx = 0; score = 0;
┬а ┬а ┬а qEl.style.display = ''; optsEl.style.display = ''; progressEl.style.display = '';
┬а ┬а ┬а renderQuestion();
┬а ┬а ┬а qWrap.scrollIntoView({behavior:'smooth'});
┬а ┬а };
┬а }

┬а // ЁЯФ╣ Dropdown рооро╛ро▒рпНро▒роорпН тАФ рокрпБродро┐роп quiz роПро▒рпНро▒рпБродро▓рпН
┬а dropdown.addEventListener('change', e => {
┬а ┬а const file = e.target.value;
┬а ┬а if (file) {
┬а ┬а ┬а loadQuiz(file);
┬а ┬а }
┬а });

}); // ЁЯФ┤ ро╕рпНроХро┐ро░ро┐рокрпНроЯро┐ройрпН роорпБроЯро┐ро╡рпИ роорпВроЯро╡рпБроорпН
</script>
